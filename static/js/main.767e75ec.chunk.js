(this["webpackJsonpjs-band-store"]=this["webpackJsonpjs-band-store"]||[]).push([[0],{40:function(e,t,c){},45:function(e,t,c){},46:function(e,t,c){},48:function(e,t,c){},49:function(e,t,c){},50:function(e,t,c){},51:function(e,t,c){},52:function(e,t,c){},53:function(e,t,c){},54:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c(17),a=c(5),s=c(13),i=c(27),o=c(6),j=c(4),l="CART/ADD_TO_CART",b="CART/EMPTY_CART",u={books:[],totalPrice:0,totalQuantity:0},d=Object(s.combineReducers)({cart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return Object(j.a)(Object(j.a)({},e),{},{books:e.books.concat(t.payload.book),totalPrice:Number(e.totalPrice)+Number(t.payload.totalPrice),totalQuantity:Number(e.totalQuantity)+Number(t.payload.quantity)});case b:return Object(j.a)({},u);default:return e}}}),h=c(3),O=c(20),x=c.p+"static/media/logo.5c2e1559.png",m=c.p+"static/media/cart.010d5d26.png",p=(c(40),c(0));var f=Object(o.b)()((function(){var e=Object(n.useRef)(null),t=Object(h.g)(),c=Object(o.d)((function(e){return e.cart}));return Object(n.useEffect)((function(){e.current.onclick=function(){localStorage.removeItem("token"),t.push("./login")}}),[]),Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("div",{className:"header__top",children:Object(p.jsx)("div",{className:"container",children:Object(p.jsxs)("div",{className:"header__top-inner",children:[Object(p.jsx)("span",{id:"currentUserName"}),Object(p.jsx)("button",{type:"button",ref:e,children:"sign out"})]})})}),Object(p.jsx)("div",{className:"header__bottom",children:Object(p.jsx)("div",{className:"container",children:Object(p.jsxs)("div",{className:"header__bottom-inner",children:[Object(p.jsx)(a.b,{to:"/catalog",children:Object(p.jsx)("img",{src:x,height:"80px",alt:"logo"})}),Object(p.jsxs)(a.b,{to:"/cart",children:[Object(p.jsx)("img",{src:m,height:"30px",alt:"cart",className:"header__bottom-cart-btn"}),Object(p.jsx)("span",{className:"header__bottom-cart-counter",children:c.totalQuantity})]})]})})})]})}));c(45);var v=function(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsxs)("p",{children:["Made with ",Object(p.jsx)("span",{style:{color:"#e25555"},children:"\u2665"})," by",Object(p.jsx)("a",{href:"https://www.linkedin.com/in/igor-gudkov/",children:" Ihor Hudkov"})]})})};var g=function(e){var t=e.component,c=Object(O.a)(e,["component"]);return Object(p.jsx)(h.b,Object(j.a)(Object(j.a)({},c),{},{render:function(e){return localStorage.getItem("token")?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(f,{}),Object(p.jsx)("main",{children:Object(p.jsx)("div",{className:"container",children:Object(p.jsx)(t,Object(j.a)({},e))})}),Object(p.jsx)(v,{})]}):Object(p.jsx)(h.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var k=function(e){var t=e.component,c=Object(O.a)(e,["component"]);return Object(p.jsx)(h.b,Object(j.a)(Object(j.a)({},c),{},{render:function(e){return localStorage.getItem("token")?Object(p.jsx)(h.a,{to:{pathname:"/catalog",state:{from:e.location}}}):Object(p.jsx)(t,Object(j.a)({},e))}}))},N=c(12),_=(c(46),c.p+"static/media/man.ad811078.svg"),y=c(18),w=c(19),P=function(){function e(t){if(Object(y.a)(this,e),e.exists)return e.instance;e.instance=this,e.exists=!0,this._name=t}return Object(w.a)(e,[{key:"name",get:function(){return this._name}},{key:"avatar",get:function(){return this._avatar},set:function(e){this._avatar=e}},{key:"token",get:function(){return this._token},set:function(e){this._token=e}}]),e}(),C=c(10),I=c.n(C),S=c(14),T=new(function(){function e(){if(Object(y.a)(this,e),e.exists)return e.instance;e.exists=!0,e.instance=this,this.url="https://js-band-store-api.glitch.me"}return Object(w.a)(e,[{key:"signIn",value:function(){var e=Object(S.a)(I.a.mark((function e(t){var c,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof P){e.next=2;break}throw new Error("FetchClient.signIn method only works with an instance of the User class");case 2:return e.next=4,fetch("".concat(this.url,"/signin"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:'{ "username" : "'.concat(t.name,'" }')});case 4:return c=e.sent,e.next=7,c.json();case 7:n=e.sent,t.avatar=n.avatar,t.token=n.token;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllBooks",value:function(){var e=Object(S.a)(I.a.mark((function e(t){var c,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.url,"/books"),{headers:{Authorization:"Bearer ".concat(t)}});case 2:return c=e.sent,e.next=5,c.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBookById",value:function(){var e=Object(S.a)(I.a.mark((function e(t,c){var n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.url,"/books/").concat(c),{headers:{Authorization:"Bearer ".concat(t)}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,c){return e.apply(this,arguments)}}()},{key:"buyBooks",value:function(){var e=Object(S.a)(I.a.mark((function e(t,c){var n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.url,"/purchase"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json;charset=utf-8"},body:'{ "books" : "'.concat(c,'" }')});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,c){return e.apply(this,arguments)}}()}]),e}());var F=function(){var e=Object(n.useState)(""),t=Object(N.a)(e,2),c=t[0],r=t[1],a=Object(n.useRef)(null);return Object(n.useEffect)((function(){a.current.onsubmit=function(e){e.preventDefault();var t=new P(a.userName);T.signIn(t).then((function(){localStorage.setItem("token",t.token),r(t.token)}),(function(e){return console.log(e.message)}))}}),[]),c?Object(p.jsx)(h.a,{to:"/catalog"}):Object(p.jsxs)("div",{className:"wrapper",children:[Object(p.jsx)("img",{src:_,alt:"man"}),Object(p.jsx)("h3",{children:"Js Band Store"}),Object(p.jsxs)("form",{ref:a,children:[Object(p.jsx)("label",{htmlFor:"userName",children:"Name"}),Object(p.jsx)("input",{type:"text",id:"userName"}),Object(p.jsx)("button",{type:"submit",children:"Log In"})]})]})};c(48);var B=function(e){var t=e.img,c=e.title,r=e.author,a=e.price,s=e.id,i=Object(h.g)(),o=Object(n.useRef)(null);return Object(n.useEffect)((function(){o.current.onclick=function(){i.push("/catalog/".concat(s))}}),[]),Object(p.jsxs)("div",{className:"card",children:[Object(p.jsx)("img",{src:t,alt:"img",className:"card__img",height:"180px"}),Object(p.jsx)("p",{className:"card__title",children:c}),Object(p.jsx)("p",{className:"card__author",children:r}),Object(p.jsxs)("div",{className:"card__wrap",children:[Object(p.jsxs)("span",{children:[a,"$"]}),Object(p.jsx)("button",{ref:o,className:"card__btn",type:"button",children:"View"})]})]})};c(49),c(50);var A=function(){var e=Object(n.useState)([]),t=Object(N.a)(e,2),c=t[0],r=t[1];return Object(n.useEffect)(Object(S.a)(I.a.mark((function e(){var t,c;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.prev=1,e.next=4,T.getAllBooks(localStorage.getItem("token"));case 4:c=e.sent,t||r((function(e){return e.concat(c)})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.message);case 11:return e.abrupt("return",(function(){return t=!0}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"row mgtop-3rem",children:[Object(p.jsx)("div",{className:"search two-thirds column",children:Object(p.jsx)("input",{type:"search",placeholder:"\ue900",className:"icon-magnifying-glass"})}),Object(p.jsx)("div",{className:"filter one-third column",children:Object(p.jsxs)("select",{className:"u-full-width",id:"exampleRecipientInput",children:[Object(p.jsx)("option",{value:"Option 1",children:"Price"}),Object(p.jsx)("option",{value:"Option 2",children:"0...25$"}),Object(p.jsx)("option",{value:"Option 3",children:"25...50$"}),Object(p.jsx)("option",{value:"Option 3",children:"over 50$"})]})})]}),Object(p.jsx)("div",{className:"catalog",children:c.map((function(e,t){return Object(p.jsx)(B,{id:e.id,img:e.cover,title:e.title,author:e.author,price:e.price},e.id?"".concat(t).concat(e.id):t)}))})]})};c(51);var R=Object(o.b)()((function(e){var t=e.visible,c=Object(o.c)(),n=Object(o.d)((function(e){return e.cart}));return t?Object(p.jsx)("div",{className:"modal",children:Object(p.jsx)("div",{className:"modal-overlay",children:Object(p.jsx)("div",{className:"container",children:Object(p.jsxs)("div",{className:"modal-window",children:[Object(p.jsx)("div",{className:"modal-window__inner",children:Object(p.jsx)("table",{className:"cart-table",children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Name"}),Object(p.jsx)("th",{children:"Count"}),Object(p.jsx)("th",{children:"Price"}),Object(p.jsx)("th",{children:"Total"})]}),n.books.map((function(e,t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.title}),Object(p.jsx)("td",{children:e.quantity}),Object(p.jsx)("td",{children:e.price}),Object(p.jsx)("td",{children:(e.quantity*e.price).toFixed(2)})]},e.id+t)}))]})})}),Object(p.jsx)("div",{className:"row__total-price",children:Object(p.jsxs)("span",{children:["Total Price: ",n.totalPrice.toFixed(2),"$"]})}),Object(p.jsx)("div",{className:"close-btn",children:Object(p.jsx)(a.b,{to:"/catalog",onClick:function(){c({type:b})},children:"Close"})})]})})})}):Object(p.jsx)(p.Fragment,{})})),E=(c(52),c.p+"static/media/black-cart.e11618bf.png"),q={background:"#d1d1d1",borderColor:"#d1d1d1"};var $=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"purchase__btn",children:Object(p.jsx)("button",{className:"button button-primary",type:"button",disabled:!0,style:q,children:"Purchase"})}),Object(p.jsxs)("div",{className:"cart-empty",children:[Object(p.jsx)("img",{src:E,alt:"img"}),Object(p.jsx)("span",{children:Object(p.jsx)("b",{children:"Cart Empty..."})})]})]})};c(53);var D=Object(o.b)()((function(){var e=Object(o.d)((function(e){return e.cart})),t=Object(n.useState)(!1),c=Object(N.a)(t,2),r=c[0],a=c[1];return e.totalPrice?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"purchase__btn",children:Object(p.jsx)("button",{className:"button button-primary",type:"button",onClick:function(){a(!0)},children:"Purchase"})}),Object(p.jsx)("table",{className:"cart-table",children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Name"}),Object(p.jsx)("th",{children:"Count"}),Object(p.jsx)("th",{children:"Price"}),Object(p.jsx)("th",{children:"Total"})]}),e.books.map((function(e,t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.title}),Object(p.jsx)("td",{children:e.quantity}),Object(p.jsx)("td",{children:e.price}),Object(p.jsx)("td",{children:(e.quantity*e.price).toFixed(2)})]},e.id+t)}))]})}),Object(p.jsx)("div",{className:"total-price",children:Object(p.jsxs)("span",{children:["Total Prise: ",e.totalPrice.toFixed(2),"$"]})}),Object(p.jsx)(R,{visible:r})]}):Object(p.jsx)($,{})}));c(54);var J=Object(o.b)()((function(){var e=Object(o.c)(),t=Object(h.h)().id,c=Object(n.useState)({}),r=Object(N.a)(c,2),a=r[0],s=r[1],i=Object(n.useRef)(),b=Object(n.useRef)();return Object(n.useEffect)((function(){T.getBookById(localStorage.getItem("token"),t).then((function(e){console.log(e),s((function(t){return Object(j.a)(Object(j.a)({},t),e)}))}))}),[]),Object(p.jsxs)("div",{className:"book",children:[Object(p.jsxs)("div",{className:"book__wrap",children:[Object(p.jsxs)("div",{className:"book__wrap-image",children:[Object(p.jsx)("div",{children:Object(p.jsx)("img",{src:a.cover,alt:"img",className:"book__image"})}),Object(p.jsx)("div",{className:"book__description",children:a.description})]}),Object(p.jsxs)("div",{className:"book__details",children:[Object(p.jsx)("p",{className:"book__details-title",children:a.title}),Object(p.jsx)("p",{className:"book__details-author",children:a.author}),Object(p.jsx)("p",{className:"book__tags",children:a.tags&&a.tags.map((function(e,t){return Object(p.jsx)("span",{children:e},t)}))})]})]}),Object(p.jsxs)("div",{className:"book__order",children:[Object(p.jsxs)("div",{className:"book__order-price",children:[Object(p.jsx)("p",{children:Object(p.jsx)("b",{children:"Price, $"})}),Object(p.jsx)("span",{children:a.price})]}),Object(p.jsxs)("div",{className:"book__order-count",children:[Object(p.jsx)("p",{children:Object(p.jsx)("b",{children:"Count"})}),Object(p.jsx)("input",{onInput:function(){b.current.textContent=a.price?(a.price*i.current.value).toFixed(2):""},ref:i,type:"number",min:"0",max:"",id:"book-counter",placeholder:"Desired quantity"})]}),Object(p.jsxs)("div",{className:"book__order-total-price",children:[Object(p.jsx)("p",{children:Object(p.jsx)("b",{children:"Total Price, $"})}),Object(p.jsx)("span",{ref:b})]}),Object(p.jsx)("button",{className:"button button-primary",type:"button",onClick:function(){var t;e((t={book:[Object(j.a)(Object(j.a)({},a),{},{quantity:Number(i.current.value)})],quantity:Number(i.current.value),totalPrice:(a.price*i.current.value).toFixed(2)},{type:l,payload:t}))},children:"Add to Cart"})]})]})}));var Q=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("h1",{children:"404 - Not Found!"}),Object(p.jsx)(a.b,{to:function(){return localStorage.getItem("token")?"/catalog":"/"},children:"Go Home"})]})};var z=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(h.d,{children:[Object(p.jsx)(k,{path:"/login",component:F}),Object(p.jsx)(h.a,{exact:!0,from:"/",to:"/login"}),Object(p.jsx)(g,{exact:!0,path:"/catalog/:id",component:J}),Object(p.jsx)(g,{path:"/cart",component:D}),Object(p.jsx)(g,{path:"/catalog",component:A}),Object(p.jsx)(h.b,{path:"/not-found",component:Q}),Object(p.jsx)(h.a,{from:"*",to:"/not-found"})]})})},H=(c(55),Object(s.createStore)(d,Object(i.composeWithDevTools)()));Object(r.render)(Object(p.jsx)(o.a,{store:H,children:Object(p.jsx)(a.a,{basename:"/JS-Band-store",children:Object(p.jsx)(z,{})})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.767e75ec.chunk.js.map